import{Q as A}from"./QSeparator-DCXVSXi9.js";import{Q as B}from"./QBadge-l-h_4b-W.js";import{a as j}from"./avatar_alt-Cq5VdRAy.js";import{d as $,u as C,k as E,r as m,H as R,m as V,z as _,b as i,e as t,t as o,F as f,g as y,q as z,I as N,o as n,f as I,i as Q,p as b,a as U,v as p,w as D}from"./index-Mo4dBhOw.js";import{d as q,a as F}from"./interpritation.service-_3ecFNJG.js";import{A as H}from"./auth.service-BOxIUbgp.js";import{T as O}from"./team.service-B4CHocZN.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-mFa0dIct.js";import"./render-DXJ7UJne.js";const J={class:"i-member-teams-title"},K=["id"],W={class:"team-title"},X=["onClick"],Y={class:"team-info"},Z={class:"team-title-panel",style:{"flex-direction":"column",width:"100%"}},ee={class:"team-description"},te={class:"team-title-panel about-team",style:{"flex-direction":"column"}},se={class:"team-description"},ae={class:"team-description"},oe={class:"team-description"},re={class:"team-description"},ie={class:"team-description"},ne={class:"team-title-panel",style:{"max-width":"100%"}},le={key:0,class:"stack-panel"},ce={style:{margin:"0"}},de={key:1},ue={class:"memberList"},me={class:"team-title-panel members-panel"},pe=["src"],ve={key:1,class:"user-avatar",src:j},_e={class:"member-info"},ge={class:"team-description",style:{"text-align":"center"}},he={class:"team-description",style:{"text-align":"center","font-size":"14px","text-decoration":"underline"}},fe=["src"],ye={key:1,class:"user-avatar",src:j},be={class:"member-info"},ke={class:"team-description",style:{"text-align":"center"}},we={class:"team-description",style:{"text-align":"center","font-size":"14px","text-decoration":"underline"}},xe=$({__name:"MemberTeamList",setup(Ie){const P=C(),L=E(()=>P.user),g=z(),T=U(),d=m([]),h=m([]),k=m({}),l=m({}),v=m({}),u=m({}),S=async(a,s)=>{try{const e=await _.get(`user/${s}`);l.value[a]=e.data,await w(e.data.id)}catch(e){console.log("Ошибка загрузки данных лидеров:",e)}},M=async(a,s)=>{try{const e=s.map(c=>_.get(`user/${c}`)),r=await Promise.all(e);k.value[a]=r.map(c=>c.data),await Promise.all(r.map(c=>w(c.data.id)))}catch(e){console.error("Ошибка загрузки данных участников:",e)}},w=async a=>{try{const s=await H.getAvatar(a);if(s&&s.size>0){const e=URL.createObjectURL(s);u.value={...u.value,[a]:e}}}catch(s){console.error(`Ошибка загрузки аватара пользователя ${a}:`,s)}},x=async()=>{g.hash&&await N(()=>{const a=document.querySelector(g.hash);a&&setTimeout(()=>{a.scrollIntoView({behavior:"smooth",block:"center"}),a.classList.add("highlight"),setTimeout(()=>{a.classList.remove("highlight")},2e3)},300)})};return R(()=>g.hash,async()=>{await x()}),V(async()=>{d.value=(await _.get(`teams/member/${L.value?.id}`)).data,d.value.forEach(a=>{M(a.id,a.members).catch(s=>console.error("Error loading members:",s))}),d.value.forEach(a=>{S(a.id,a.teamLeaderId).catch(s=>console.error("Error loading leaders:",s))}),await Promise.all(d.value.map(async a=>{v.value[a.id]=await O.loadStack(a.id),a.currentProjectId&&h.value.push((await _.get(`project/${a.currentProjectId}`)).data)})),await x()}),(a,s)=>(n(),i("div",null,[t("p",J,"Команд: "+o(d.value.length),1),(n(!0),i(f,null,y(d.value,e=>(n(),i("div",{key:e.id,id:`team-${e.id}`},[I(A),t("div",null,[t("p",W,o(e.title),1)]),e.currentProjectId?(n(),i("p",{key:0,class:"working-team",onClick:r=>b(T).push({name:"projects",params:{projectId:e.currentProjectId,rialtoId:h.value.find(c=>c.id===e.currentProjectId)?.rialtoId}})},[t("strong",null,"Занимается проектом: "+o(h.value.find(r=>r.id===e.currentProjectId)?.title),1)],8,X)):Q("",!0),t("div",Y,[t("div",Z,[s[0]||(s[0]=t("p",{class:"team-description"},[t("strong",null,"Описание:")],-1)),t("p",ee,o(e.description),1)]),t("div",te,[t("p",se,[s[1]||(s[1]=t("strong",null,"Тим-лидер:",-1)),p(" "+o(l.value[e.id]?.firstname)+" "+o(l.value[e.id]?.lastname),1)]),t("p",ae,[s[2]||(s[2]=t("strong",null,"Дата создания:",-1)),p(" "+o(b(q)(e.createdAt)),1)]),t("p",oe,[s[3]||(s[3]=t("strong",null,"Статус:",-1)),p(" "+o(e.currentProjectId?"В работе":"В поисках"),1)]),t("p",re,[s[4]||(s[4]=t("strong",null,"Приватность:",-1)),p(" "+o(b(F)[e.status]),1)]),t("p",ie,[s[5]||(s[5]=t("strong",null,"Количество участников:",-1)),p(" "+o(e.members.length+1),1)])])]),t("div",ne,[v.value[e.id]?.length&&v.value[e.id].length>0?(n(),i("div",le,[s[6]||(s[6]=t("p",{class:"team-description",style:{"align-self":"center"}},[t("strong",null,"Стек технологий: ")],-1)),(n(!0),i(f,null,y(v.value[e.id],r=>(n(),i("div",{class:"stack-card",key:r},[t("p",ce,o(r),1)]))),128))])):(n(),i("div",de,s[7]||(s[7]=[t("p",{class:"team-description",style:{"align-self":"center"}},[t("strong",null,"Стек отсутствует")],-1)])))]),t("div",ue,[t("div",me,[l.value[e.id]?.id&&u.value[l.value[e.id]?.id??""]?(n(),i("img",{key:0,class:"user-avatar",src:u.value[l.value[e.id]?.id??""]??""},null,8,pe)):(n(),i("img",ve)),t("div",_e,[I(B,{color:"accent",style:{"align-self":"center","margin-bottom":"10px"},class:"leader-badge"},{default:D(()=>s[8]||(s[8]=[p("Тим-лидер")])),_:1}),t("p",ge,o(l.value[e.id]?.firstname)+" "+o(l.value[e.id]?.lastname),1),t("p",he,o(l.value[e.id]?.mail),1)])]),(n(!0),i(f,null,y(k.value[e.id],r=>(n(),i("div",{class:"team-title-panel members-panel",key:r.id},[u.value[r.id]?(n(),i("img",{key:0,class:"user-avatar",src:u.value[r.id]??""},null,8,fe)):(n(),i("img",ye)),t("div",be,[t("p",ke,o(r.firstname)+" "+o(r.lastname),1),t("p",we,o(r.mail),1)])]))),128))])],8,K))),128))]))}}),Ee=G(xe,[["__scopeId","data-v-07b44c10"]]);export{Ee as default};
